dat = data.frame(
        matrix(c(78, 74, 68, 76, 80, 84, 50, 93, 55, 76, 58, 74, 75,
                 80, 56, 80, 69, 57, 90, 42, 91, 51, 79, 53, 82, 51,
                 76, 82, 84, 53, 86, 51, 85, 45, 88, 51, 80, 49, 82,
                 75, 73, 67, 68, 86, 72, 75, 75, 66, 84, 70, 79, 60, 86,

                 4.4, 3.9, 4.0, 4.0, 3.5, 4.1, 2.3, 4.7, 1.7, 4.9, 1.7, 4.6, 3.4,
                 4.3, 1.7, 3.9, 3.7, 3.1, 4.0, 1.8, 4.1, 1.8, 3.2, 1.9, 4.6, 2.0,
                 4.5, 3.9, 4.3, 2.3, 3.8, 1.9, 4.6, 1.8, 4.7, 1.8, 4.6, 1.9, 3.5,
                 4.0, 3.7, 3.7, 4.3, 3.6, 3.8, 3.8, 3.8, 2.5, 4.5, 4.1, 3.7, 3.8, 3.4), ncol=2)
                 )

lmod = lm(X1 ~ X2, dat)
summary(lmod)
# B0: 31.752
# B1: 11.368

print("##########################################################################")

lmodH = lm(X1 ~ 1, dat)
anova(lmodH, lmod)
# Reject Null Hypothesis

print("##########################################################################")

confint(lmod, level=0.95)
                2.5 %   97.5 %
(Intercept) 24.345472 39.15910
X2           9.313375 13.42223

print("##########################################################################")

#0.7018

print("##########################################################################")

lmod$fitted.value

1        2        3        4        5        6        7        8
81.77062 76.08672 77.22350 77.22350 71.53960 78.36028 57.89824 85.18097
9       10       11       12       13       14       15       16
51.07755 87.45453 51.07755 84.04419 70.40282 80.63384 51.07755 76.08672
17       18       19       20       21       22       23       24
73.81316 66.99248 77.22350 52.21433 78.36028 52.21433 68.12926 53.35111
25       26       27       28       29       30       31       32
84.04419 54.48789 82.90740 76.08672 80.63384 57.89824 74.94994 53.35111
33       34       35       36       37       38       39       40
84.04419 52.21433 85.18097 52.21433 84.04419 53.35111 71.53960 77.22350
41       42       43       44       45       46       47       48
73.81316 73.81316 80.63384 72.67638 74.94994 74.94994 74.94994 60.17180
49       50       51       52       53
82.90740 78.36028 73.81316 74.94994 70.40282

print("##########################################################################")

plot(dat$X1, , xlab="observation", ylab="data", ylim=c(min(dat$X1, lmod$fitted.values), max(dat$X1, lmod$fitted.values)))
lines(lmod$fitted.values, col="red")
points(lmod$fitted.values, col="red", pch=16)

print("##########################################################################")

dat2 = data.frame(
        matrix(c(
                29, 33, 53, 3.32, 3.42,
                40, 90, 64, 7.32, 6.70,
                24, 31, 36, 3.10, 3.26,
                46, 90, 60, 7.32, 7.20,
                26, 33, 51, 3.18, 3.18,
                55, 92, 92, 7.45, 7.45,
                22, 37, 51, 3.39, 3.08,
                52, 91, 92, 7.27, 7.26,
                27, 36, 54, 3.20, 3.41,
                29, 61, 62, 3.91, 4.08,
                21, 35, 35, 3.03, 3.03,
                22, 59, 42, 3.75, 3.45,
                33, 59, 56, 4.78, 4.57,
                31, 88, 65, 6.48, 5.80,
                34, 60, 60, 4.72, 4.72,
                45, 91, 89, 6.70, 6.60,
                32, 59, 60, 4.60, 4.41,
                37, 63, 62, 4.30, 4.30,
                34, 60, 60, 4.53, 4.53,
                37, 60, 61, 4.02, 4.10,
                20, 34, 35, 2.90, 2.95,
                33, 60, 62, 4.02, 3.89,
                36, 60, 59, 4.40, 4.36,
                27, 59, 62, 3.98, 4.02,
                34, 60, 62, 4.31, 4.42,
                34, 59, 62, 4.39, 4.53,
                23, 60, 36, 4.27, 3.94,
                19, 37, 35, 2.75, 2.64,
                24, 62, 38, 4.41, 3.49,
                16, 35, 35, 2.59, 2.59,
                32, 62, 61, 4.39, 4.39,
                22, 37, 37, 2.73, 2.59),
                ncol=5, byrow=T)
                )

summary(dat2)
       X1              X2              X3              X4
 Min.   :16.00   Min.   :31.00   Min.   :35.00   Min.   :2.590
 1st Qu.:23.75   1st Qu.:37.00   1st Qu.:41.00   1st Qu.:3.290
 Median :31.50   Median :60.00   Median :60.00   Median :4.285
 Mean   :31.12   Mean   :57.91   Mean   :55.91   Mean   :4.422
 3rd Qu.:34.50   3rd Qu.:62.00   3rd Qu.:62.00   3rd Qu.:4.630
 Max.   :55.00   Max.   :92.00   Max.   :92.00   Max.   :7.450
       X5
 Min.   :2.590
 1st Qu.:3.373
 Median :4.090
 Mean   :4.324
 3rd Qu.:4.540
 Max.   :7.450

 print("##########################################################################")

 lmod21 = lm(X1 ~ X2, dat2)
 summary(lmod21)
 # B0: 8.15344
 # B1: 0.39670

 lmod22 = lm(X1 ~ X2 + X3, dat2)
 summary(lmod22)
 # B0: 0.22987
 # B1: 0.14625
 # B2: 0.40114

 print("##########################################################################")

 confint(lmod21, level=0.95)
                 2.5 %     97.5 %
 (Intercept) 1.9969201 14.3099680
 X2          0.2957882  0.4976169

 confint(lmod22, level=0.95)
                   2.5 %    97.5 %
 (Intercept) -4.62873294 5.0884784
 X2           0.03999343 0.2525158
 X3           0.26935561 0.5329185

 print("##########################################################################")

 plot(dat2$X1, , xlab="observation", ylab="data", ylim=c(min(dat2$X1, lmod21$fitted.values, lmod22$fitted.values), max(dat2$X1, lmod21$fitted.values, lmod22$fitted.values)))
 lines(lmod21$fitted.values, col="red")
 points(lmod21$fitted.values, col="red", pch=16)

 lines(lmod22$fitted.values, col="blue")
 points(lmod22$fitted.values, col="blue", pch=16)

 print("##########################################################################")

 dat3 = data.frame(matrix(c(41.5,45.9,162,23,3,
          33.8,53.3,162,23,8,
          27.7,57.5,162,30,5,
          21.7,58.8,162,30,8,
          19.9,60.6,172,25,5,
          15.0,58.0,172,25,8,
          12.2,58.6,172,30,5,
          4.3 ,52.4,172,30,8,
          19.3,56.9,167,27.5,6.5,
          6.4 ,55.4,177,27.5,6.5,
          37.6,46.9,157,27.5,6.5,
          18.0,57.3,167,32.5,6.5,
          26.3,55.0,167,22.5,6.5,
          9.9 ,58.9,167,27.5,9.5,
          25.0,50.3,167,27.5,3.5,
          14.1,61.1,177,20  ,6.5,
          15.2,62.9,177,20  ,6.5,
          15.9,60.0,160,34  ,7.5,
          19.6,60.6,160,34  ,7.5), ncol=5, byrow=T))
names(dat3) = c("y1", "y2", "x1", "x2", "x3")
summary(dat3)

V1              V2              V3              V4              V5
Min.   : 4.30   Min.   :45.90   Min.   :157.0   Min.   :20.00   Min.   :3.00
1st Qu.:14.55   1st Qu.:54.15   1st Qu.:162.0   1st Qu.:24.00   1st Qu.:5.75
Median :19.30   Median :57.50   Median :167.0   Median :27.50   Median :6.50
Mean   :20.18   Mean   :56.34   Mean   :167.3   Mean   :27.18   Mean   :6.50
3rd Qu.:25.65   3rd Qu.:59.45   3rd Qu.:172.0   3rd Qu.:30.00   3rd Qu.:7.75
Max.   :41.50   Max.   :62.90   Max.   :177.0   Max.   :34.00   Max.   :9.50

print("##########################################################################")

plot(dat3)
#y1 and x1 has positive correlation

print("##########################################################################")

lmod31 = lm(y1 ~ x1 + x2 + x3, dat3)
summary(lmod31)

Coefficients:
             Estimate Std. Error t value Pr(>|t|)
(Intercept) 332.11098   18.69293  17.767 1.74e-11 ***
x1           -1.54596    0.09903 -15.610 1.10e-10 ***
x2           -1.42456    0.14765  -9.648 7.99e-08 ***
x3           -2.23737    0.33982  -6.584 8.67e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.312 on 15 degrees of freedom
Multiple R-squared:  0.9551,	Adjusted R-squared:  0.9462
F-statistic: 106.5 on 3 and 15 DF,  p-value: 2.459e-10

lmod32 = lm(y2 ~ x1 + x2 + x3, dat3)
summary(lmod32)

Call:
lm(formula = y2 ~ x1 + x2 + x3, data = dat3)

Residuals:
    Min      1Q  Median      3Q     Max
-8.2075 -2.0557  0.1633  3.2712  4.7503

Coefficients:
            Estimate Std. Error t value Pr(>|t|)
(Intercept) -26.0353    32.9734  -0.790   0.4421
x1            0.4046     0.1747   2.316   0.0351 *
x2            0.2930     0.2604   1.125   0.2783
x3            1.0338     0.5994   1.725   0.1051
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 4.078 on 15 degrees of freedom
Multiple R-squared:  0.3771,	Adjusted R-squared:  0.2525
F-statistic: 3.027 on 3 and 15 DF,  p-value: 0.06235

print("##########################################################################")

dat4 = data.frame(matrix(c(
         18.38, 15.30, 17.25, .24,
         8.50, 9.00, 8.89, .08,
         20.00, 22.29, 18.51, .20,
         36.50, 20.64, 23.81, .24,
         11.50, 12.36, 11.13, .12,
         60.00, 81.40, 4.54, .05,
         25.00, 31.84, 5.54, .12,
         16.25, 18.92, 29.62, .72,
         52.50, 83.90, 5.44, .04,
         50.00, 50.32, 21.36, .19,
         82.50, 72.25, 20.37, .05,
         11.50, 21.33, 1.53, .10,
         25.00, 27.14, 31.20, .27,
         35.00, 46.85, 5.42, .08,
         30.67, 40.41, 4.29, .10,
         75.00, 65.94, 22.10, .09,
         12.00, 12.42, 8.69, .41,
         31.56, 38.68, 14.55, .17,
         61.25, 69.42, 6.63, .04,
         48.50, 51.19, 7.59, .13,
         60.00, 48.46, 27.40, .12,
         77.50, 59.42, 49.86, .13,
         57.50, 69.00, 31.23, .08,
         21.67, 24.64, 11.46, .21,
         31.00, 26.09, 28.50, .21,
         19.75, 26.94, 2.48, .10,
         60.00, 62.83, 29.98, .17,
         56.00, 46.20, 31.62, .26,
         72.50, 77.06, 13.59, .05,
         25.00, 26.86, 53.73, .43,
         60.33, 58.83, 45.46, .16,
         40.00, 20.00, 40.18, .56,
         49.75, 59.48, 35.90, .32,
         56.67, 62.52, 15.89, .05),
         ncol=4, byrow=T))

lmod4 = lm(X1 ~ X2 + X3 + X4, dat4)
summary(lmod4)

Coefficients:
             Estimate Std. Error t value Pr(>|t|)
(Intercept)   0.68356    4.83255   0.141 0.888461
X2            0.77995    0.08099   9.630 1.09e-10 ***
X3            0.50315    0.12515   4.020 0.000361 ***
X4          -17.11515   13.59570  -1.259 0.217787
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 8.247 on 30 degrees of freedom
Multiple R-squared:  0.8667,	Adjusted R-squared:  0.8534
F-statistic: 65.02 on 3 and 30 DF,  p-value: 3.12e-13

confint(lmod4, level=0.95)

                2.5 %     97.5 %
(Intercept)  -9.1858297 10.5529531
X2            0.6145368  0.9453550
X3            0.2475486  0.7587418
X4          -44.8812786 10.6509731


plot(dat4$X1, , xlab="observation", ylab="data", ylim=c(min(dat4$X1, lmod4$fitted.values), max(dat4$X1, lmod4$fitted.values)))
lines(lmod4$fitted.values, col="red")
points(lmod4$fitted.values, col="red", pch=16)
